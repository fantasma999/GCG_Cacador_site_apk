
<!DOCTYPE html>
<html>
<head>
    <title>Painel - GCG Ca√ßador</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        .logout-btn {
            background: #ff4444;
            color: white;
            padding: 8px 15px;
            text-decoration: none;
            border-radius: 5px;
            font-size: 14px;
        }
        .section {
            background: #2a2a2a;
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: #333;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #00ff00;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff00;
        }
        button {
            background: #00ff00;
            color: #1a1a1a;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }
        button:hover {
            background: #00cc00;
        }
        input {
            background: #1a1a1a;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            margin: 5px;
        }
        .form-row {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
        }
        .response {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #004d00; color: #00ff00; }
        .error { background: #4d0000; color: #ff4444; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîê Painel Administrativo - {{ info.app_name }}</h1>
        <a href="/logout" class="logout-btn">Logout</a>
    </div>

    <div class="stats">
        <div class="stat-card">
            <div>BTC Total Encontrado</div>
            <div class="stat-value">{{ "%.8f"|format(dados.btc_total) }} BTC</div>
        </div>
        <div class="stat-card">
            <div>Endere√ßos Encontrados</div>
            <div class="stat-value">{{ dados.enderecos_encontrados }}</div>
        </div>
        <div class="stat-card">
            <div>Vers√£o do Sistema</div>
            <div class="stat-value">{{ info.version }}</div>
        </div>
    </div>

    <div class="section">
        <h3>üîç Verifica√ß√£o de BTC</h3>
        <button onclick="iniciarVerificacao()">Iniciar Nova Verifica√ß√£o</button>
        <div id="verificacao-response" class="response" style="display:none;"></div>
    </div>

    <div class="section">
        <h3>üí∞ Saque Total</h3>
        <form onsubmit="saqueTotal(event)">
            <div class="form-row">
                <input type="text" id="endereco-total" placeholder="Endere√ßo BTC de destino" required>
                <button type="submit">Sacar Todo o Saldo</button>
            </div>
        </form>
        <div id="saque-total-response" class="response" style="display:none;"></div>
    </div>

    <div class="section">
        <h3>üí∏ Saque Parcial</h3>
        <form onsubmit="saqueParcial(event)">
            <div class="form-row">
                <input type="text" id="endereco-parcial" placeholder="Endere√ßo BTC" required>
                <input type="number" id="valor-parcial" placeholder="Valor BTC" step="0.00000001" required>
                <button type="submit">Sacar Valor Espec√≠fico</button>
            </div>
        </form>
        <div id="saque-parcial-response" class="response" style="display:none;"></div>
    </div>

    <div class="section">
        <h3>üìä Consultas de Saldo</h3>
        <button onclick="consultarBTC()">Consultar Saldo BTC</button>
        <button onclick="consultarETH()">Consultar Saldo ETH</button>
        <div id="consulta-response" class="response" style="display:none;"></div>
    </div>

    <script>
        async function iniciarVerificacao() {
            try {
                const response = await fetch('/verificar');
                const data = await response.json();
                const div = document.getElementById('verificacao-response');
                div.style.display = 'block';
                div.className = 'response success';
                div.innerHTML = `‚úÖ ${data.message}<br>Total: ${data.dados.btc_total} BTC<br>Endere√ßos: ${data.dados.enderecos_encontrados}`;
                location.reload(); // Atualizar estat√≠sticas
            } catch (error) {
                showError('verificacao-response', 'Erro na verifica√ß√£o: ' + error.message);
            }
        }

        async function saqueTotal(event) {
            event.preventDefault();
            const endereco = document.getElementById('endereco-total').value;
            
            try {
                const response = await fetch('/sacar', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    body: `endereco=${encodeURIComponent(endereco)}`
                });
                const data = await response.json();
                showResponse('saque-total-response', data.message, data.status === 'sucesso');
            } catch (error) {
                showError('saque-total-response', 'Erro no saque: ' + error.message);
            }
        }

        async function saqueParcial(event) {
            event.preventDefault();
            const endereco = document.getElementById('endereco-parcial').value;
            const valor = document.getElementById('valor-parcial').value;
            
            try {
                const response = await fetch('/real-withdrawal', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({destiny: endereco, value: valor})
                });
                const data = await response.json();
                showResponse('saque-parcial-response', data.message, data.done);
            } catch (error) {
                showError('saque-parcial-response', 'Erro no saque: ' + error.message);
            }
        }

        async function consultarBTC() {
            try {
                const response = await fetch('/balance_btc');
                const data = await response.json();
                showResponse('consulta-response', 
                    `üí∞ Saldo BTC: ${data.balance} BTC\nüîó Confirma√ß√µes: ${data.confirmations}`, true);
            } catch (error) {
                showError('consulta-response', 'Erro na consulta BTC: ' + error.message);
            }
        }

        async function consultarETH() {
            try {
                const response = await fetch('/balance_eth');
                const data = await response.json();
                showResponse('consulta-response', `üíé Saldo ETH: ${data.balance} ETH`, true);
            } catch (error) {
                showError('consulta-response', 'Erro na consulta ETH: ' + error.message);
            }
        }

        function showResponse(elementId, message, isSuccess) {
            const div = document.getElementById(elementId);
            div.style.display = 'block';
            div.className = `response ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = `${isSuccess ? '‚úÖ' : '‚ùå'} ${message}`;
        }

        function showError(elementId, message) {
            showResponse(elementId, message, false);
        }
    </script>
</body>
</html>
